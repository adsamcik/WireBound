<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:WireBound.ViewModels"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
             x:Class="WireBound.Views.ChartsPage"
             x:DataType="vm:DashboardViewModel"
             BackgroundColor="{StaticResource BackgroundColor}">

    <!-- 
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    WireBound Live Chart v2.0 - Premium Visualization
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Full-screen chart experience with glassmorphism stats overlay
    -->

    <Grid RowDefinitions="Auto, Auto, *, Auto" Padding="28" RowSpacing="20">
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- HEADER WITH TIME RANGE                                          -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <Grid ColumnDefinitions="*, Auto">
            <VerticalStackLayout Spacing="4">
                <Label Text="Live Chart" 
                       Style="{StaticResource PageTitleStyle}">
                    <Label.Shadow>
                        <Shadow Brush="{StaticResource GlowDownloadColor}" 
                                Offset="0,0" 
                                Radius="8" 
                                Opacity="0.2" />
                    </Label.Shadow>
                </Label>
                <Label Text="Real-time network speed visualization"
                       Style="{StaticResource SubtitleStyle}" />
            </VerticalStackLayout>
            
            <!-- Time Range Selector -->
            <Border Grid.Column="1"
                    Style="{StaticResource CompactCardStyle}"
                    VerticalOptions="Center"
                    Padding="14,10">
                <HorizontalStackLayout Spacing="12">
                    <Label Text="â±ï¸"
                           FontSize="16"
                           VerticalOptions="Center" />
                    <Label Text="Time Range"
                           Style="{StaticResource CaptionStyle}"
                           VerticalOptions="Center" />
                    <Picker ItemsSource="{Binding TimeRangeOptions}"
                            SelectedItem="{Binding SelectedTimeRange}"
                            ItemDisplayBinding="{Binding Label}"
                            TextColor="{StaticResource PrimaryTextColor}"
                            BackgroundColor="{StaticResource SurfaceColor}"
                            WidthRequest="100"
                            VerticalOptions="Center" />
                </HorizontalStackLayout>
            </Border>
        </Grid>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- STATISTICS ROW                                                   -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <Border Grid.Row="1" Style="{StaticResource CardStyle}" Padding="20">
            <Grid ColumnDefinitions="*, *, *, *" ColumnSpacing="20">
                
                <!-- Peak Download -->
                <Border BackgroundColor="{StaticResource BorderSubtleColor}"
                        StrokeShape="RoundRectangle 12"
                        Padding="16,12">
                    <VerticalStackLayout HorizontalOptions="Center" Spacing="6">
                        <HorizontalStackLayout Spacing="6" HorizontalOptions="Center">
                            <Label Text="â¬‡ï¸" FontSize="12" />
                            <Label Text="PEAK DOWNLOAD"
                                   Style="{StaticResource MetricLabelStyle}" />
                        </HorizontalStackLayout>
                        <Label Text="{Binding PeakDownloadSpeed}"
                               FontSize="22"
                               FontAttributes="Bold"
                               TextColor="{StaticResource DownloadColor}"
                               HorizontalOptions="Center">
                            <Label.Shadow>
                                <Shadow Brush="{StaticResource GlowDownloadColor}" 
                                        Offset="0,0" 
                                        Radius="6" 
                                        Opacity="0.3" />
                            </Label.Shadow>
                        </Label>
                    </VerticalStackLayout>
                </Border>
                
                <!-- Avg Download -->
                <Border Grid.Column="1"
                        BackgroundColor="{StaticResource BorderSubtleColor}"
                        StrokeShape="RoundRectangle 12"
                        Padding="16,12">
                    <VerticalStackLayout HorizontalOptions="Center" Spacing="6">
                        <HorizontalStackLayout Spacing="6" HorizontalOptions="Center">
                            <Label Text="ðŸ“Š" FontSize="12" />
                            <Label Text="AVG DOWNLOAD"
                                   Style="{StaticResource MetricLabelStyle}" />
                        </HorizontalStackLayout>
                        <Label Text="{Binding AverageDownloadSpeed}"
                               FontSize="22"
                               FontAttributes="Bold"
                               TextColor="{StaticResource DownloadColorDim}"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Border>
                
                <!-- Peak Upload -->
                <Border Grid.Column="2"
                        BackgroundColor="{StaticResource BorderSubtleColor}"
                        StrokeShape="RoundRectangle 12"
                        Padding="16,12">
                    <VerticalStackLayout HorizontalOptions="Center" Spacing="6">
                        <HorizontalStackLayout Spacing="6" HorizontalOptions="Center">
                            <Label Text="â¬†ï¸" FontSize="12" />
                            <Label Text="PEAK UPLOAD"
                                   Style="{StaticResource MetricLabelStyle}" />
                        </HorizontalStackLayout>
                        <Label Text="{Binding PeakUploadSpeed}"
                               FontSize="22"
                               FontAttributes="Bold"
                               TextColor="{StaticResource UploadColor}"
                               HorizontalOptions="Center">
                            <Label.Shadow>
                                <Shadow Brush="{StaticResource GlowUploadColor}" 
                                        Offset="0,0" 
                                        Radius="6" 
                                        Opacity="0.3" />
                            </Label.Shadow>
                        </Label>
                    </VerticalStackLayout>
                </Border>
                
                <!-- Avg Upload -->
                <Border Grid.Column="3"
                        BackgroundColor="{StaticResource BorderSubtleColor}"
                        StrokeShape="RoundRectangle 12"
                        Padding="16,12">
                    <VerticalStackLayout HorizontalOptions="Center" Spacing="6">
                        <HorizontalStackLayout Spacing="6" HorizontalOptions="Center">
                            <Label Text="ðŸ“Š" FontSize="12" />
                            <Label Text="AVG UPLOAD"
                                   Style="{StaticResource MetricLabelStyle}" />
                        </HorizontalStackLayout>
                        <Label Text="{Binding AverageUploadSpeed}"
                               FontSize="22"
                               FontAttributes="Bold"
                               TextColor="{StaticResource UploadColorDim}"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Border>
            </Grid>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- MAIN CHART                                                       -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <Border Grid.Row="2" Style="{StaticResource ElevatedCardStyle}">
            <Grid RowDefinitions="Auto, *, Auto" RowSpacing="16">
                
                <!-- Chart Header: Legend + Pause Status -->
                <Grid ColumnDefinitions="*, Auto, *">
                    
                    <!-- Legend -->
                    <HorizontalStackLayout Grid.Column="1" Spacing="32" HorizontalOptions="Center">
                        <HorizontalStackLayout Spacing="10">
                            <Border BackgroundColor="{StaticResource DownloadColor}"
                                    StrokeThickness="0"
                                    WidthRequest="24"
                                    HeightRequest="4"
                                    VerticalOptions="Center">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="2" />
                                </Border.StrokeShape>
                                <Border.Shadow>
                                    <Shadow Brush="{StaticResource GlowDownloadColor}" 
                                            Offset="0,0" 
                                            Radius="4" 
                                            Opacity="0.6" />
                                </Border.Shadow>
                            </Border>
                            <Label Text="Download"
                                   FontSize="13"
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryTextColor}"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>
                        <HorizontalStackLayout Spacing="10">
                            <Border BackgroundColor="{StaticResource UploadColor}"
                                    StrokeThickness="0"
                                    WidthRequest="24"
                                    HeightRequest="4"
                                    VerticalOptions="Center">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="2" />
                                </Border.StrokeShape>
                                <Border.Shadow>
                                    <Shadow Brush="{StaticResource GlowUploadColor}" 
                                            Offset="0,0" 
                                            Radius="4" 
                                            Opacity="0.6" />
                                </Border.Shadow>
                            </Border>
                            <Label Text="Upload"
                                   FontSize="13"
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource PrimaryTextColor}"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </HorizontalStackLayout>
                    
                    <!-- Pause Status + Return to Live -->
                    <HorizontalStackLayout Grid.Column="2" 
                                           Spacing="12"
                                           HorizontalOptions="End"
                                           VerticalOptions="Center"
                                           IsVisible="{Binding IsUpdatesPaused}">
                        <Border BackgroundColor="{StaticResource WarningBannerColor}"
                                StrokeShape="RoundRectangle 6"
                                Padding="10,6">
                            <Label Text="{Binding PauseStatusText}"
                                   FontSize="12"
                                   TextColor="{StaticResource WarningColor}"
                                   VerticalOptions="Center" />
                        </Border>
                        <Button Text="â–¶ Return to Live"
                                Command="{Binding ReturnToLiveCommand}"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Padding="14,8"
                                FontSize="12" />
                    </HorizontalStackLayout>
                </Grid>
                
                <!-- The Chart -->
                <!-- NOTE: Using SurfaceColor instead of Transparent to prevent rendering ghosting -->
                <!-- LiveCharts2 has a known issue where transparent backgrounds cause frame accumulation -->
                <lvc:CartesianChart Grid.Row="1"
                                    x:Name="SpeedChart"
                                    Series="{Binding SpeedSeries}"
                                    Sections="{Binding ThresholdSections}"
                                    XAxes="{Binding XAxes}"
                                    YAxes="{Binding YAxes}"
                                    ZoomMode="X"
                                    TooltipPosition="Top"
                                    FindingStrategy="CompareAll"
                                    BackgroundColor="{StaticResource SurfaceColor}" />
                
                <!-- Interaction Hint -->
                <Border Grid.Row="2"
                        BackgroundColor="{StaticResource BorderSubtleColor}"
                        StrokeShape="RoundRectangle 8"
                        Padding="12,8"
                        HorizontalOptions="Center">
                    <HorizontalStackLayout Spacing="8">
                        <Label Text="ðŸ’¡" FontSize="12" VerticalOptions="Center" />
                        <Label Text="Scroll to zoom â€¢ Drag to pan â€¢ Change time range above"
                               FontSize="12"
                               TextColor="{StaticResource SecondaryTextColor}"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>
            </Grid>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- CURRENT SPEED FOOTER                                             -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        
        <Border Grid.Row="3" Style="{StaticResource CardStyle}" Padding="20">
            <Grid ColumnDefinitions="*, Auto, *" ColumnSpacing="24">
                
                <!-- Download Speed -->
                <HorizontalStackLayout Spacing="16" HorizontalOptions="Center">
                    <Border BackgroundColor="#1500E5FF"
                            StrokeShape="RoundRectangle 10"
                            Stroke="Transparent"
                            WidthRequest="48"
                            HeightRequest="48"
                            VerticalOptions="Center">
                        <Label Text="â†“"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="{StaticResource DownloadColor}"
                               HorizontalOptions="Center"
                               VerticalOptions="Center" />
                    </Border>
                    <VerticalStackLayout VerticalOptions="Center" Spacing="2">
                        <Label Text="Download Speed"
                               Style="{StaticResource CaptionStyle}" />
                        <Label Text="{Binding DownloadSpeed}"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="{StaticResource DownloadColor}">
                            <Label.Shadow>
                                <Shadow Brush="{StaticResource GlowDownloadColor}" 
                                        Offset="0,0" 
                                        Radius="8" 
                                        Opacity="0.4" />
                            </Label.Shadow>
                        </Label>
                    </VerticalStackLayout>
                </HorizontalStackLayout>
                
                <!-- Divider -->
                <BoxView Grid.Column="1"
                         Style="{StaticResource VerticalDividerStyle}" />
                
                <!-- Upload Speed -->
                <HorizontalStackLayout Grid.Column="2" Spacing="16" HorizontalOptions="Center">
                    <Border BackgroundColor="#15FF6B35"
                            StrokeShape="RoundRectangle 10"
                            Stroke="Transparent"
                            WidthRequest="48"
                            HeightRequest="48"
                            VerticalOptions="Center">
                        <Label Text="â†‘"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="{StaticResource UploadColor}"
                               HorizontalOptions="Center"
                               VerticalOptions="Center" />
                    </Border>
                    <VerticalStackLayout VerticalOptions="Center" Spacing="2">
                        <Label Text="Upload Speed"
                               Style="{StaticResource CaptionStyle}" />
                        <Label Text="{Binding UploadSpeed}"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="{StaticResource UploadColor}">
                            <Label.Shadow>
                                <Shadow Brush="{StaticResource GlowUploadColor}" 
                                        Offset="0,0" 
                                        Radius="8" 
                                        Opacity="0.4" />
                            </Label.Shadow>
                        </Label>
                    </VerticalStackLayout>
                </HorizontalStackLayout>
            </Grid>
        </Border>
    </Grid>
</ContentPage>
