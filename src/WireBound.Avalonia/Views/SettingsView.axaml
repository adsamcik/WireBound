<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:WireBound.Avalonia.ViewModels"
             x:Class="WireBound.Avalonia.Views.SettingsView"
             x:DataType="vm:SettingsViewModel"
             Background="{DynamicResource BackgroundBrush}"
             AutomationProperties.Name="Settings View">

    <ScrollViewer Margin="28">
        <StackPanel Spacing="24">
            
            <!-- Header -->
            <StackPanel Spacing="4">
                <TextBlock Text="Settings" Classes="PageTitle" />
                <TextBlock Text="Configure monitoring options" Classes="Subtitle" />
            </StackPanel>

            <!-- Network Settings -->
            <Border Classes="ElevatedCard">
                <StackPanel Spacing="24">
                    
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Border Background="#1500E5FF" CornerRadius="8" Width="40" Height="40">
                            <TextBlock Text="ðŸ“¡" FontSize="20"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Monitoring Settings" Classes="SectionHeader" />
                            <TextBlock Text="Configure how network data is collected" Classes="Caption" />
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Network Adapter -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Network Adapter" Classes="CardTitle" />
                                <TextBlock Text="Select which adapter to monitor" Classes="Caption" />
                            </StackPanel>
                            <ComboBox Grid.Column="1"
                                      ItemsSource="{Binding Adapters}"
                                      SelectedItem="{Binding SelectedAdapter}"
                                      Width="220"
                                      VerticalAlignment="Center"
                                      AutomationProperties.Name="Network Adapter"
                                      AutomationProperties.HelpText="Select which network adapter to monitor">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </Grid>
                    </Border>
                    
                    <!-- Polling Interval -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Polling Interval" Classes="CardTitle" />
                                <TextBlock Text="How often to sample network data" Classes="Caption" />
                            </StackPanel>
                            <ComboBox Grid.Column="1"
                                      ItemsSource="{Binding PollingIntervals}"
                                      SelectedItem="{Binding PollingIntervalMs}"
                                      Width="120"
                                      VerticalAlignment="Center"
                                      AutomationProperties.Name="Polling Interval"
                                      AutomationProperties.HelpText="How frequently network data is sampled" />
                        </Grid>
                    </Border>
                    
                    <!-- Speed Unit -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Speed Unit" Classes="CardTitle" />
                                <TextBlock Text="Display speeds in bits (Mbps) or bytes (MB/s)" Classes="Caption" />
                            </StackPanel>
                            <ComboBox Grid.Column="1"
                                      ItemsSource="{Binding SpeedUnits}"
                                      SelectedItem="{Binding SelectedSpeedUnit}"
                                      Width="160"
                                      VerticalAlignment="Center"
                                      AutomationProperties.Name="Speed Unit"
                                      AutomationProperties.HelpText="Choose to display speeds in bits per second or bytes per second">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource SpeedUnitConverter}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </Grid>
                    </Border>
                    
                    <!-- Use IP Helper API -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Use IP Helper API" Classes="CardTitle" />
                                <TextBlock Text="More accurate readings but may require elevation" Classes="Caption" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="1"
                                          IsChecked="{Binding UseIpHelperApi}"
                                          VerticalAlignment="Center"
                                          AutomationProperties.Name="Use IP Helper API"
                                          AutomationProperties.HelpText="Enable more accurate network readings, may require administrator privileges" />
                        </Grid>
                    </Border>
                    
                    <!-- Per-App Tracking -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Per-App Network Tracking" Classes="CardTitle" />
                                <TextBlock Text="Track network usage for individual applications" Classes="Caption" />
                                <TextBlock Text="âš ï¸ Requires administrator privileges"
                                           Classes="Caption"
                                           Foreground="{DynamicResource WarningBrush}"
                                           IsVisible="{Binding RequiresElevation}" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="1"
                                          IsChecked="{Binding IsPerAppTrackingEnabled}"
                                          IsEnabled="{Binding IsElevated}"
                                          VerticalAlignment="Center"
                                          AutomationProperties.Name="Per-App Network Tracking"
                                          AutomationProperties.HelpText="Track network usage for individual applications. Requires administrator privileges." />
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Application Settings -->
            <Border Classes="ElevatedCard">
                <StackPanel Spacing="24">
                    
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Border Background="#15FF6B35" CornerRadius="8" Width="40" Height="40">
                            <TextBlock Text="ðŸ–¥ï¸" FontSize="20"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Application Settings" Classes="SectionHeader" />
                            <TextBlock Text="Startup and behavior options" Classes="Caption" />
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Start with Windows -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Start with Windows" Classes="CardTitle" />
                                <TextBlock Text="Launch WireBound when Windows starts" Classes="Caption" />
                                <TextBlock Text="âš ï¸ Disabled in Windows Settings > Apps > Startup"
                                           Classes="Caption"
                                           Foreground="{DynamicResource WarningBrush}"
                                           IsVisible="{Binding IsStartupDisabledByUser}" />
                                <TextBlock Text="âš ï¸ Disabled by system policy"
                                           Classes="Caption"
                                           Foreground="{DynamicResource WarningBrush}"
                                           IsVisible="{Binding IsStartupDisabledByPolicy}" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="1"
                                          IsChecked="{Binding StartWithWindows}"
                                          VerticalAlignment="Center"
                                          AutomationProperties.Name="Start with Windows"
                                          AutomationProperties.HelpText="Launch WireBound automatically when Windows starts" />
                        </Grid>
                    </Border>
                    
                    <!-- Minimize to Tray -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Minimize to System Tray" Classes="CardTitle" />
                                <TextBlock Text="Keep running in background when minimized" Classes="Caption" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="1"
                                          IsChecked="{Binding MinimizeToTray}"
                                          VerticalAlignment="Center"
                                          AutomationProperties.Name="Minimize to System Tray"
                                          AutomationProperties.HelpText="Keep the application running in the background when minimized" />
                        </Grid>
                    </Border>
                    
                    <!-- Start Minimized -->
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <TextBlock Text="Start Minimized" Classes="CardTitle" />
                                <TextBlock Text="Start the application minimized to system tray" Classes="Caption" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="1"
                                          IsChecked="{Binding StartMinimized}"
                                          VerticalAlignment="Center"
                                          AutomationProperties.Name="Start Minimized"
                                          AutomationProperties.HelpText="Start the application minimized to the system tray" />
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Elevation Status -->
            <Border Classes="ElevatedCard">
                <StackPanel Spacing="24">
                    
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Border Background="#15FFB627" CornerRadius="8" Width="40" Height="40">
                            <TextBlock Text="ðŸ›¡ï¸" FontSize="20"
                                       HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Administrator Privileges" Classes="SectionHeader" />
                            <TextBlock Text="Elevation status for advanced features" Classes="Caption" />
                        </StackPanel>
                    </StackPanel>
                    
                    <Border Background="{DynamicResource BorderSubtleBrush}" CornerRadius="12" Padding="16">
                        <Grid ColumnDefinitions="*, Auto">
                            <StackPanel Spacing="4">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Current Status:" Classes="CardTitle" />
                                    <TextBlock Text="Running as Administrator"
                                               Foreground="{DynamicResource SuccessBrush}"
                                               FontWeight="Bold"
                                               IsVisible="{Binding IsElevated}"
                                               VerticalAlignment="Center" />
                                    <TextBlock Text="Standard User"
                                               Foreground="{DynamicResource WarningBrush}"
                                               FontWeight="Bold"
                                               IsVisible="{Binding !IsElevated}"
                                               VerticalAlignment="Center" />
                                </StackPanel>
                                <TextBlock Text="Per-app network tracking requires administrator privileges"
                                           Classes="Caption"
                                           IsVisible="{Binding RequiresElevation}" />
                                <TextBlock Text="All features are available"
                                           Classes="Caption"
                                           Foreground="{DynamicResource SuccessBrush}"
                                           IsVisible="{Binding IsElevated}" />
                            </StackPanel>
                            <Button Grid.Column="1"
                                    Content="ðŸ›¡ï¸ Elevate"
                                    Command="{Binding RequestElevationCommand}"
                                    IsEnabled="{Binding !IsRequestingElevation}"
                                    IsVisible="{Binding RequiresElevation}"
                                    Classes="Warning"
                                    VerticalAlignment="Center"
                                    AutomationProperties.Name="Elevate to Administrator"
                                    AutomationProperties.HelpText="Restart the application with administrator privileges" />
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Auto-save note -->
            <TextBlock Text="Settings are saved automatically"
                       Classes="Caption"
                       HorizontalAlignment="Center"
                       Opacity="0.6" />
                   
        </StackPanel>
    </ScrollViewer>
</UserControl>
